#include <iostream>\n#include <vector>\n#include <string>\n#include <cassert>\n#include <sstream>\n\n// Test includes\n#include \"../include/batch_introspection_command.h\"\n#include \"../include/cli_types.h\"\n\nusing namespace nx::cli;\n\n// Capture stdout for testing\nclass OutputCapture {\npublic:\n    OutputCapture() : old_cout(std::cout.rdbuf()) {\n        std::cout.rdbuf(buffer.rdbuf());\n    }\n    \n    ~OutputCapture() {\n        std::cout.rdbuf(old_cout);\n    }\n    \n    std::string get_output() {\n        return buffer.str();\n    }\n    \nprivate:\n    std::ostringstream buffer;\n    std::streambuf* old_cout;\n};\n\nvoid test_inspect_plan_basic() {\n    std::cout << \"Testing inspect plan basic...\\n\";\n    \n    OutputCapture capture;\n    std::vector<std::string> args = {\"plan\", \"test_batch_001\"};\n    auto result = BatchIntrospectionCommand::execute(args);\n    std::string output = capture.get_output();\n    \n    assert(result.success);\n    assert(result.error_code == CliErrorCode::NONE);\n    \n    // Verify JSON structure\n    assert(output.find(\"\\\"batch_id\\\": \\\"test_batch_001\\\"\") != std::string::npos);\n    assert(output.find(\"\\\"plan_hash\\\": \\\"sha256:abc123def456\\\"\") != std::string::npos);\n    assert(output.find(\"\\\"job_count\\\": 3\") != std::string::npos);\n    assert(output.find(\"\\\"jobs\\\":\") != std::string::npos);\n    assert(output.find(\"\\\"dag\\\":\") != std::string::npos);\n    \n    std::cout << \"✓ Basic plan output correct\\n\";\n}\n\nvoid test_inspect_plan_jobs_only() {\n    std::cout << \"Testing inspect plan --jobs-only...\\n\";\n    \n    OutputCapture capture;\n    std::vector<std::string> args = {\"plan\", \"test_batch_001\", \"--jobs-only\"};\n    auto result = BatchIntrospectionCommand::execute(args);\n    std::string output = capture.get_output();\n    \n    assert(result.success);\n    \n    // Should have jobs but not dag\n    assert(output.find(\"\\\"jobs\\\":\") != std::string::npos);\n    assert(output.find(\"\\\"dag\\\":\") == std::string::npos);\n    \n    std::cout << \"✓ Jobs-only flag works\\n\";\n}\n\nvoid test_inspect_plan_dag_only() {\n    std::cout << \"Testing inspect plan --dag-only...\\n\";\n    \n    OutputCapture capture;\n    std::vector<std::string> args = {\"plan\", \"test_batch_001\", \"--dag-only\"};\n    auto result = BatchIntrospectionCommand::execute(args);\n    std::string output = capture.get_output();\n    \n    assert(result.success);\n    \n    // Should have dag but not jobs\n    assert(output.find(\"\\\"jobs\\\":\") == std::string::npos);\n    assert(output.find(\"\\\"dag\\\":\") != std::string::npos);\n    \n    std::cout << \"✓ DAG-only flag works\\n\";\n}\n\nvoid test_inspect_jobs_basic() {\n    std::cout << \"Testing inspect jobs basic...\\n\";\n    \n    OutputCapture capture;\n    std::vector<std::string> args = {\"jobs\", \"test_batch_001\"};\n    auto result = BatchIntrospectionCommand::execute(args);\n    std::string output = capture.get_output();\n    \n    assert(result.success);\n    assert(result.error_code == CliErrorCode::NONE);\n    \n    // Verify JSON structure\n    assert(output.find(\"\\\"batch_id\\\": \\\"test_batch_001\\\"\") != std::string::npos);\n    assert(output.find(\"\\\"jobs\\\":\") != std::string::npos);\n    assert(output.find(\"\\\"job_id\\\": \\\"job_001\\\"\") != std::string::npos);\n    assert(output.find(\"\\\"job_type\\\": \\\"convert\\\"\") != std::string::npos);\n    assert(output.find(\"\\\"execution_order\\\": 1\") != std::string::npos);\n    assert(output.find(\"\\\"dependency_count\\\": 0\") != std::string::npos);\n    \n    std::cout << \"✓ Basic jobs output correct\\n\";\n}\n\nvoid test_inspect_jobs_sort_id() {\n    std::cout << \"Testing inspect jobs --sort id...\\n\";\n    \n    OutputCapture capture;\n    std::vector<std::string> args = {\"jobs\", \"test_batch_001\", \"--sort\", \"id\"};\n    auto result = BatchIntrospectionCommand::execute(args);\n    std::string output = capture.get_output();\n    \n    assert(result.success);\n    \n    // Should be sorted by job ID (job_001, job_002, job_003)\n    size_t pos_001 = output.find(\"\\\"job_id\\\": \\\"job_001\\\"\");\n    size_t pos_002 = output.find(\"\\\"job_id\\\": \\\"job_002\\\"\");\n    size_t pos_003 = output.find(\"\\\"job_id\\\": \\\"job_003\\\"\");\n    \n    assert(pos_001 != std::string::npos);\n    assert(pos_002 != std::string::npos);\n    assert(pos_003 != std::string::npos);\n    assert(pos_001 < pos_002);\n    assert(pos_002 < pos_003);\n    \n    std::cout << \"✓ ID sorting works\\n\";\n}\n\nvoid test_inspect_jobs_filter_type() {\n    std::cout << \"Testing inspect jobs --filter-type...\\n\";\n    \n    OutputCapture capture;\n    std::vector<std::string> args = {\"jobs\", \"test_batch_001\", \"--filter-type\", \"convert\"};\n    auto result = BatchIntrospectionCommand::execute(args);\n    std::string output = capture.get_output();\n    \n    assert(result.success);\n    \n    // Should only have convert job\n    assert(output.find(\"\\\"job_type\\\": \\\"convert\\\"\") != std::string::npos);\n    assert(output.find(\"\\\"job_type\\\": \\\"validate\\\"\") == std::string::npos);\n    assert(output.find(\"\\\"job_type\\\": \\\"archive\\\"\") == std::string::npos);\n    \n    std::cout << \"✓ Type filtering works\\n\";\n}\n\nvoid test_error_handling() {\n    std::cout << \"Testing error handling...\\n\";\n    \n    // Test missing batch ID\n    {\n        std::vector<std::string> args = {\"plan\"};\n        auto result = BatchIntrospectionCommand::execute(args);\n        assert(!result.success);\n        assert(result.error_code == CliErrorCode::NX_CLI_USAGE_ERROR);\n    }\n    \n    // Test unknown batch ID\n    {\n        OutputCapture capture;\n        std::vector<std::string> args = {\"plan\", \"unknown_batch\"};\n        auto result = BatchIntrospectionCommand::execute(args);\n        assert(!result.success);\n        assert(result.error_code == CliErrorCode::ERROR_BATCH_NOT_FOUND);\n    }\n    \n    // Test invalid enum\n    {\n        std::vector<std::string> args = {\"jobs\", \"test_batch_001\", \"--sort\", \"invalid\"};\n        auto result = BatchIntrospectionCommand::execute(args);\n        assert(!result.success);\n        assert(result.error_code == CliErrorCode::NX_CLI_ENUM_ERROR);\n    }\n    \n    std::cout << \"✓ Error handling works\\n\";\n}\n\nint main() {\n    std::cout << \"=== Phase 14A Golden Tests ===\\n\\n\";\n    \n    try {\n        test_inspect_plan_basic();\n        test_inspect_plan_jobs_only();\n        test_inspect_plan_dag_only();\n        test_inspect_jobs_basic();\n        test_inspect_jobs_sort_id();\n        test_inspect_jobs_filter_type();\n        test_error_handling();\n        \n        std::cout << \"\\n✅ All golden tests passed\\n\";\n        std::cout << \"Phase 14A.2 implementation verified\\n\";\n        \n        return 0;\n    } catch (const std::exception& e) {\n        std::cerr << \"❌ Test failed: \" << e.what() << std::endl;\n        return 1;\n    }\n}